
> 리눅스 컨테이너를 기반으로 특정한 서비스를 패키징하고 배포하는데 유용한 오픈소스 프로그램

### 도커를 사용해야 하는 이유
1. 특정한 소프트웨어를 개발한 이후 배포하고자 할 때 해당 프로그램이 어디에선가 손쉽게 구동되도록 하기 위함
2. 리눅스에서 다양한 환경구성을 할 수 있음


- Dockerfile -\> Docker Image -\> Docker Container

# Docker File - 개발용 DockerFile 별도 관리하기
> Docker File은 Docker Image를 만들기 위한 설정 파일이다.
> 여러가지 명령어를 토대로 Docker File을 작성하면 설정된 내용대로 Docker Image를 만들 수 있다.
	- FROM : 기반이 되는 이미지 레이어 ex) ubuntu:14.04
	- MAINTAINER : 메인테이너 정보(유저)

	- **RUN**
		- ["<커맨드>", "<파라미터1>"], <전체 커맨드>
		- 쉘에서 커맨드를 실행하는 것처럼 이미지 빌드 과정에서 필요한 커맨드를 실행하기 위해 사용
		- 보통 이미지 안에 특정 소프트웨어를 설치하기 위해 많이 사용함

	- ENTRYPOINT 
		- ["<커맨드>", "<파라미터1>"], <전체 커맨드>
		- 이미지를 컨테이너로 띄울 때 항상 실행되야 하는 커맨드를 지정할 떄 사용
		- Docker 이미지를 마치 하나의 실행 파일처럼 사용할 때 유용
		- 컨테이너가 뜰 때 지정된 커맨드가 실행되고, 이 커맨드로 실행된 프로세스가 죽을 때 컨테이너도 같이 종료됨

	- VOLUME : 디렉터리의 내용을 컨테이너에 저장하지 않고 호스트에 저장하도록 설정

	- **CMD**
		- 컨테이너가 시작되었을 때 실행할 실행 파일 또는 쉘 스크립트
		- 해당 이미지를 컨테이너로 띄울 때 디폴트로 실행할 커맨드나 명령문으로 지정된 커맨드에 디폴트로 넘길 파라미터를 지정할 때 사용
		- RUN과의 차이
			- RUN은 이미지 빌드 시 항상 실행되며 한 Docker File에 여러 개의 RUN 명령문을 선언할 수 있음
			- CMD는 이미지를 container로 띄울 때 딱 한번 실행 기회를 가지며 이 마저도 docker run 커맨드에 인자를 넘길 경우 상실하게 됨

	- **WORKDIR**
		- <이동할 경로>
		- 컨테이너 상에서 작업 디렉터리로 전환을 위해 사용 (작업 디렉터리를 전환하면 그 이후 등장하는 모든 RUN, CMD, ENTRYPOINT, COPY, ADD 명령문은 해당 디렉터리를 기준으로 실행됨
		- CMD에서 설정한 실행 파일이 실행될 디렉터리

	- **EXPOSE**
	- `EXPOSE <포트>`, `EXPOSE <포트>/<프로토콜>`
	- 네트워크 상에서 컨테이너로 들어오는 트래픽을 리스닝하는 포트와 프로토콜을 지정하기 위해 사용
	- 프로토콜은 TCP, UDP 중 선택할 수 있음 (Default == TCP)

	- **COPY**
	- 호스트 컴퓨터에 있는 디렉터리나 파일을 Docker 이미지의 파일 시스템으로 복사히기 위해 사용됨
	- 절대경로와 상대경로를 모두 지원하며, 상대경로를 사용할 때는 이 전에 등장하는 `WORKDIR` 명령으로 작업 디렉터리를 어디로 전환하였는지 고려해야 함

	- **ADD**
	- 좀 더 파워풀한 COPY 명령문
	- 일반 파일 뿐 아니라 압축 파일이나 네트워크 상의 파일도 사용 가능
	- 특수한 파일을 다루는 게 아니라면 COPY를 권장

	- **ENV**
	- `ENV <KEY> <VALUE>`
	- 환경 변수를 설정하기 위해 사용
	- ENV 명령문으로 설정된 환경 변수는 이미지 빌드 시에도 사용됨은 물론, 해당 컨테이너에서 돌아가는 애플리케이션도 접근할 수 있다

	- **ARG**
	- `ARG <name>=<Default>`
	- docker build 로 이미지 빌드 시 --build-arg 옵션을 통해 넘길 수 있는 인자를 정의하기 위해 사용
	- 설정된 인자값은 `${name}` 형태로 읽을 수 있음

	- .dockerignore
	- Docker 이미지를 빌드할 때 제외하고 싶은 파일이 있다면 추가

- **정리**
	명령어	                               용도
	FROM	                      base 이미지 설정
	WORKDIR	              작업 디렉터리 설정
	RUN	                      이미지 빌드 시 커맨드 실행
	ENTRYPOINT	      이미지 실행 시 항상 실행되야 하는 커맨드 설정
	CMD	                      이미지 실행 시 디폴트 커맨드 또는 파라미터 설정
	EXPOSE	                      컨테이너가 리스닝할 포트 및 프로토콜 설정
	COPY/ADD	              이미지의 파일 시스템으로 파일 또는 디렉터리 복사
	ENV	                              환경 변수 설정
	ARG	                      빌드 시 넘어올 수 있는 인자 설정